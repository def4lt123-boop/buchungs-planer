<!DOCTYPE html>
<html>
<head>
    <title>Supabase CORS Test</title>
</head>
<body style="background: #000; color: #fff; font-family: monospace; padding: 2rem;">
    <h1>üîç Supabase CORS Test</h1>
    <div id="result"></div>
    
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        const SUPABASE_URL = 'https://njewqngqmwojsxhzycfq.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5qZXdxbmdxbXdvanN4aHp5Y2ZxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzc5NzY2MTQsImV4cCI6MjA1MzU1MjYxNH0.HUDfg_Yd_EAa2bQ8M1Kb-6EbDnvqmxkItWU-TjDCU88';
        
        const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        const result = document.getElementById('result');
        
        result.innerHTML = '<p>üîÑ Testing...</p>';
        
        // Test 1: Simple REST request
        fetch(SUPABASE_URL + '/rest/v1/', {
            headers: {
                'apikey': SUPABASE_ANON_KEY,
                'Authorization': 'Bearer ' + SUPABASE_ANON_KEY
            }
        })
        .then(response => {
            result.innerHTML += `<p>‚úÖ REST API: ${response.status} ${response.statusText}</p>`;
            if (response.status === 200 || response.status === 401) {
                result.innerHTML += '<p style="color: lime;">üéâ CORS funktioniert! Problem liegt woanders.</p>';
            }
            return response.text();
        })
        .then(text => {
            result.innerHTML += `<pre style="background: #222; padding: 1rem; border-radius: 8px; overflow: auto;">${text}</pre>`;
        })
        .catch(error => {
            result.innerHTML += `<p style="color: red;">‚ùå CORS ERROR: ${error.message}</p>`;
            result.innerHTML += '<p style="color: yellow;">‚ö†Ô∏è L√ñSUNG: Setze Site URL in Supabase!</p>';
            result.innerHTML += '<p>1. Gehe zu Supabase Dashboard</p>';
            result.innerHTML += '<p>2. Settings ‚Üí Authentication ‚Üí URL Configuration</p>';
            result.innerHTML += '<p>3. Setze Site URL auf: <code style="background: #333; padding: 4px;">https://springerplan.vercel.app</code></p>';
            result.innerHTML += '<p>4. F√ºge Redirect URL hinzu: <code style="background: #333; padding: 4px;">https://springerplan.vercel.app/*</code></p>';
        });
        
        // Test 2: Auth request
        setTimeout(async () => {
            try {
                result.innerHTML += '<p>üîÑ Testing Auth...</p>';
                const { data, error } = await supabase.auth.getSession();
                if (error) throw error;
                result.innerHTML += '<p>‚úÖ Auth API: OK</p>';
            } catch (error) {
                result.innerHTML += `<p style="color: red;">‚ùå Auth ERROR: ${error.message}</p>`;
            }
        }, 1000);
    </script>
</body>
</html>
